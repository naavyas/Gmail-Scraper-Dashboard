{"ast":null,"code":"var _jsxFileName = \"/Users/naavyasethi/Desktop/dashboard v2/frontend/src/components/Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { Bar } from 'react-chartjs-2';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from 'chart.js';\nimport './Dashboard.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\nconst getInitials = email => {\n  const [name] = email.split('@');\n  return name.split(/[._-]/).map(part => {\n    var _part$;\n    return ((_part$ = part[0]) === null || _part$ === void 0 ? void 0 : _part$.toUpperCase()) || '';\n  }).join('').slice(0, 2);\n};\nconst Dashboard = () => {\n  _s();\n  const [data, setData] = useState(null);\n  const [needsAuth, setNeedsAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Always try to fetch the stacked summary\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // If redirected with ?auth=success, reload data\n  useEffect(() => {\n    if (window.location.search.includes('auth=success')) {\n      window.history.replaceState({}, document.title, window.location.pathname);\n      fetchData();\n    }\n  }, []);\n  const fetchData = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await axios.get('/api/emails/stacked-summary');\n      setData(res.data);\n      setNeedsAuth(false);\n    } catch (err) {\n      setNeedsAuth(true);\n      setData(null);\n      setError(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleAuth = () => {\n    window.location.href = '/auth';\n  };\n\n  // Prepare stacked bar chart data\n  const getChartData = () => {\n    if (!data) return null;\n    const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#C9CBCF', '#4BC0C0', '#FF6384', '#FFCE56'];\n    return {\n      labels: data.weeks,\n      datasets: data.users.map((user, idx) => ({\n        label: user.email,\n        data: user.data,\n        backgroundColor: colors[idx % colors.length],\n        stack: 'Stack 0'\n      }))\n    };\n  };\n  const chartOptions = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: 'top',\n        labels: {\n          generateLabels: chart => {\n            const datasets = chart.data.datasets || [];\n            return datasets.map((ds, i) => ({\n              text: ds.label,\n              fillStyle: ds.backgroundColor,\n              strokeStyle: ds.backgroundColor,\n              hidden: !chart.isDatasetVisible(i),\n              datasetIndex: i,\n              fontColor: '#22223b',\n              pointStyle: 'circle',\n              initials: getInitials(ds.label)\n            }));\n          }\n        }\n      },\n      title: {\n        display: true,\n        text: 'Outbound Emails per User (Stacked by Week)'\n      }\n    },\n    scales: {\n      x: {\n        stacked: true\n      },\n      y: {\n        stacked: true,\n        beginAtZero: true\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Gmail Analytics Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Track your team's outbound email activity by week.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this), needsAuth ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"auth-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\uD83D\\uDD11 Authentication Required\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please authenticate with Google to access your Gmail analytics.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"auth-button\",\n          onClick: handleAuth,\n          children: \"Connect Gmail\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this) : loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"spinner\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Loading chart data...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this) : data ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chart-container\",\n        children: /*#__PURE__*/_jsxDEV(Bar, {\n          data: getChartData(),\n          options: chartOptions\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n};\n_s(Dashboard, \"3WO7ObUGSQxoNr+uxCtiTFBZr8k=\");\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","axios","Bar","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","jsxDEV","_jsxDEV","register","getInitials","email","name","split","map","part","_part$","toUpperCase","join","slice","Dashboard","_s","data","setData","needsAuth","setNeedsAuth","loading","setLoading","error","setError","fetchData","window","location","search","includes","history","replaceState","document","title","pathname","res","get","err","handleAuth","href","getChartData","colors","labels","weeks","datasets","users","user","idx","label","backgroundColor","length","stack","chartOptions","responsive","plugins","legend","position","generateLabels","chart","ds","i","text","fillStyle","strokeStyle","hidden","isDatasetVisible","datasetIndex","fontColor","pointStyle","initials","display","scales","x","stacked","y","beginAtZero","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","options","_c","$RefreshReg$"],"sources":["/Users/naavyasethi/Desktop/dashboard v2/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { Bar } from 'react-chartjs-2';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend,\n} from 'chart.js';\nimport './Dashboard.css';\n\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\n\nconst getInitials = (email) => {\n  const [name] = email.split('@');\n  return name\n    .split(/[._-]/)\n    .map(part => part[0]?.toUpperCase() || '')\n    .join('')\n    .slice(0, 2);\n};\n\nconst Dashboard = () => {\n  const [data, setData] = useState(null);\n  const [needsAuth, setNeedsAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Always try to fetch the stacked summary\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // If redirected with ?auth=success, reload data\n  useEffect(() => {\n    if (window.location.search.includes('auth=success')) {\n      window.history.replaceState({}, document.title, window.location.pathname);\n      fetchData();\n    }\n  }, []);\n\n  const fetchData = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await axios.get('/api/emails/stacked-summary');\n      setData(res.data);\n      setNeedsAuth(false);\n    } catch (err) {\n      setNeedsAuth(true);\n      setData(null);\n      setError(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAuth = () => {\n    window.location.href = '/auth';\n  };\n\n  // Prepare stacked bar chart data\n  const getChartData = () => {\n    if (!data) return null;\n    const colors = [\n      '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',\n      '#FF9F40', '#C9CBCF', '#4BC0C0', '#FF6384', '#FFCE56'\n    ];\n    return {\n      labels: data.weeks,\n      datasets: data.users.map((user, idx) => ({\n        label: user.email,\n        data: user.data,\n        backgroundColor: colors[idx % colors.length],\n        stack: 'Stack 0',\n      }))\n    };\n  };\n\n  const chartOptions = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: 'top',\n        labels: {\n          generateLabels: (chart) => {\n            const datasets = chart.data.datasets || [];\n            return datasets.map((ds, i) => ({\n              text: ds.label,\n              fillStyle: ds.backgroundColor,\n              strokeStyle: ds.backgroundColor,\n              hidden: !chart.isDatasetVisible(i),\n              datasetIndex: i,\n              fontColor: '#22223b',\n              pointStyle: 'circle',\n              initials: getInitials(ds.label),\n            }));\n          },\n        }\n      },\n      title: { display: true, text: 'Outbound Emails per User (Stacked by Week)' }\n    },\n    scales: {\n      x: { stacked: true },\n      y: { stacked: true, beginAtZero: true }\n    }\n  };\n\n  return (\n    <div className=\"dashboard\">\n      <div className=\"card\">\n        <h1>Gmail Analytics Dashboard</h1>\n        <p>Track your team's outbound email activity by week.</p>\n        {needsAuth ? (\n          <div className=\"auth-section\">\n            <h2>🔑 Authentication Required</h2>\n            <p>Please authenticate with Google to access your Gmail analytics.</p>\n            <button className=\"auth-button\" onClick={handleAuth}>\n              Connect Gmail\n            </button>\n          </div>\n        ) : loading ? (\n          <div className=\"loading\">\n            <div className=\"spinner\"></div>\n            <div>Loading chart data...</div>\n          </div>\n        ) : data ? (\n          <div className=\"chart-container\">\n            <Bar data={getChartData()} options={chartOptions} />\n          </div>\n        ) : error ? (\n          <div className=\"error\">{error}</div>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nexport default Dashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}